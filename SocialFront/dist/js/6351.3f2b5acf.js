"use strict";(self["webpackChunksocial_vue_3"]=self["webpackChunksocial_vue_3"]||[]).push([[6351],{4754:function(e,t,r){r.d(t,{D_:function(){return u},Hj:function(){return d},Iu:function(){return f},Ry:function(){return i},UY:function(){return s},VQ:function(){return m},VY:function(){return o},ZT:function(){return l},bm:function(){return p},gO:function(){return h},gb:function(){return c},hg:function(){return g},wk:function(){return a}});var n=r(6593);function a(e){return(0,n.E)({url:`article/chainInfo/${e}`,method:"get"})}function o(e){return(0,n.E)({url:`article/${e}`,method:"get"})}function s(e,t){return(0,n.E)({url:`article/commentList/${e}`,method:"get",params:{userId:t}})}function l(e){return(0,n.E)({url:"article/addComment",method:"post",data:e})}function i(e,t){return(0,n.E)({url:`article/likeComment/${e}`,method:"post",params:{userId:t}})}function c(e,t){return(0,n.E)({url:"article/addBookmark",method:"post",params:{userId:e,articleId:t}})}function u(e,t){return(0,n.E)({url:"article/removeBookmark",method:"post",params:{userId:e,articleId:t}})}function d(e,t){return(0,n.E)({url:"article/addLike",method:"post",params:{userId:e,articleId:t}})}function m(e,t){return(0,n.E)({url:"article/addDislike",method:"post",params:{userId:e,articleId:t}})}function p(e,t){return(0,n.E)({url:"article/removeLove",method:"post",params:{userId:e,articleId:t}})}function f(e){return(0,n.E)({url:"article/upload",method:"post",data:e})}function h(e){return(0,n.E)({url:"article/recordBlockchain",method:"post",data:e})}function g(e,t=1){const r=null!==t?t:1;let a=`/article/myList?page=${r}`;return a+=`&userId=${e}`,(0,n.E)({url:a,method:"get"})}},3761:function(e,t,r){r.d(t,{A:function(){return i}});var n=r(641),a=r(33),o={__name:"Notification",props:{message:{type:String,required:!0},type:{type:String,default:"info"}},emits:["close"],setup(e,{emit:t}){const r=e,o=t,s=(0,n.EW)((()=>{switch(r.type){case"success":return"success";case"warning":return"warning";case"error":return"error";default:return"info"}})),l=()=>{o("close")};return(0,n.sV)((()=>{setTimeout((()=>{l()}),3e3)})),(t,r)=>((0,n.uX)(),(0,n.CE)("div",{class:(0,a.C4)(["notification",s.value])},[(0,n.Lk)("span",null,(0,a.v_)(e.message),1)],2))}},s=r(6262);const l=(0,s.A)(o,[["__scopeId","data-v-07b198c4"]]);var i=l},6351:function(e,t,r){r.r(t),r.d(t,{default:function(){return C}});r(4114);var n=r(641),a=r(3751),o=r(953),s=r(33),l=r(4754),i=r(6278),c=r(5208),u=r(5220),d=r(3761);const m={class:"row justify-content-center"},p={class:"col-md-10"},f={class:"card iq-border-radius-40"},h={class:"card-body"},g={class:"form-group row"},v={class:"col-sm-10"},b={class:"form-group row"},y={class:"col-md-12"},k={class:"form-group"},w=["src"],L={class:"form-group row"},I={class:"col-sm-12"},E=["value"];var x={__name:"EmailCompose",setup(e){const t=(0,o.Kh)({show:!1,message:"",type:"info"}),r=(0,u.rd)(),x=(0,i.Pj)(),_=(0,o.KR)((0,c.zM)("boards"));let C=(0,o.Kh)({author_id:x.state.userInfo?.id,title:"",content:"",username:x.state.userInfo?.name,address:x.state.userInfo?.address,publicationDate:"",chained:!1,images:[]});const R=(0,o.KR)([]),D=e=>{const t=Array.from(e.target.files);R.value=[],t.forEach((e=>{const t=new FileReader;t.onload=e=>{R.value.push(e.target.result)},t.readAsDataURL(e)})),C.images=t},j=async()=>{if(console.log(C.boardId),!C.title||C.title.length>30||!C.content||void 0===C.boardId)return t.message="請填寫標題、內容並選擇看板。",t.type="warning",void(t.show=!0);C.content.length>500&&(t.message="文章請勿超過500字。",t.type="warning",t.show=!0);try{const e=new FormData;e.append("id",C.author_id),e.append("title",C.title),e.append("content",C.content),e.append("username",C.username),e.append("address",C.address),e.append("publicationDate",(new Date).getTime()),e.append("chained",C.chained),e.append("boardId",C.boardId),C.images.forEach((t=>{e.append("images",t)}));const n=await(0,l.Iu)(e);1===n.data.code?(r.push("/"),t.message="文章發布成功!",t.type="success",t.show=!0):(t.message="上傳失敗，請稍後再試。",t.type="error",t.show=!0),C.title="",C.content="",C.chained=!1,C.images=[],R.value=[]}catch(e){console.error("Error uploading article:",e)}};return(0,n.sV)((()=>{null===x.state.userInfo&&(t.message="請先登入。",t.type="warning",t.show=!0,r.push("/"))})),(e,r)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",m,[(0,n.Lk)("div",p,[(0,n.Lk)("div",f,[(0,n.Lk)("div",h,[r[9]||(r[9]=(0,n.Lk)("div",{class:"row"},[(0,n.Lk)("div",{class:"col-md-10 mb-3"},[(0,n.Lk)("h5",{class:"text-primary card-title d-flex gap-1"},[(0,n.Lk)("span",{class:"material-symbols-outlined"},"drive_file_rename_outline"),(0,n.eW)(" 建立新文章 ")])])],-1)),(0,n.Lk)("form",{class:"email-form justify-content-center",onSubmit:(0,a.D$)(j,["prevent"])},[(0,n.Lk)("div",g,[r[4]||(r[4]=(0,n.Lk)("label",{for:"title",class:"col-sm-2 col-form-label"},"輸入標題",-1)),(0,n.Lk)("div",v,[(0,n.bo)((0,n.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":r[0]||(r[0]=e=>(0,o.R1)(C).title=e),class:"form-control",placeholder:"輸入標題"},null,512),[[a.Jo,(0,o.R1)(C).title]])])]),(0,n.Lk)("div",b,[(0,n.Lk)("div",y,[(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":r[1]||(r[1]=e=>(0,o.R1)(C).content=e),class:"textarea form-control",rows:"5",placeholder:"輸入內文"},null,512),[[a.Jo,(0,o.R1)(C).content]])])]),(0,n.Lk)("div",k,[r[5]||(r[5]=(0,n.Lk)("label",{for:"cover-photo",class:"form-label"},"上傳圖片",-1)),(0,n.Lk)("input",{type:"file",id:"cover-photo",multiple:"",onChange:D,class:"form-control"},null,32),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(R.value,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"mt-2"},[(0,n.Lk)("img",{src:e,class:"img-thumbnail",width:"200"},null,8,w)])))),128)),r[6]||(r[6]=(0,n.Lk)("small",{class:"form-text text-muted"},"PNG, JPG, GIF up to 10MB",-1))]),(0,n.Lk)("div",L,[r[7]||(r[7]=(0,n.Lk)("label",{for:"board",class:"form-label"},"請選擇看板",-1)),(0,n.Lk)("div",I,[(0,n.bo)((0,n.Lk)("select",{class:"form-control","onUpdate:modelValue":r[2]||(r[2]=e=>(0,o.R1)(C).boardId=e)},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(_.value,(e=>((0,n.uX)(),(0,n.CE)("option",{value:e.id,key:e.id},(0,s.v_)(e.name),9,E)))),128))],512),[[a.u1,(0,o.R1)(C).boardId]])])]),r[8]||(r[8]=(0,n.Fv)('<div class="form-group d-flex flex-wrap align-items-center justify-content-between mb-0"><div class="d-flex flex-wrap flex-grow-1 align-items-center"><div class="send-btn pl-3 mb-2"><button type="submit" class="btn btn-primary">確定</button></div><div class="send-panel mb-2"><label class="ms-2 mb-0 bg-soft-primary rounded" for="file"><input type="file" id="file" style="display:none;"><a><i class="ri-attachment-line text-primary"></i></a></label></div></div><div class="d-flex align-items-center"><div class="send-panel float-right"><label class="ms-2 mb-0 bg-soft-primary rounded"><a href="../../" class="material-symbols-outlined">delete</a></label></div></div></div>',1))],32)])])])]),t.show?((0,n.uX)(),(0,n.Wv)(d.A,{key:0,message:t.message,type:t.type,onClose:r[3]||(r[3]=e=>t.show=!1)},null,8,["message","type"])):(0,n.Q3)("",!0)],64))}};const _=x;var C=_},4527:function(e,t,r){var n=r(3724),a=r(4376),o=TypeError,s=Object.getOwnPropertyDescriptor,l=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,t){if(a(e)&&!s(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},6837:function(e){var t=TypeError,r=9007199254740991;e.exports=function(e){if(e>r)throw t("Maximum allowed index exceeded");return e}},4114:function(e,t,r){var n=r(6518),a=r(8981),o=r(6198),s=r(4527),l=r(6837),i=r(9039),c=i((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=c||!u();n({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=a(this),r=o(t),n=arguments.length;l(r+n);for(var i=0;i<n;i++)t[r]=arguments[i],r++;return s(t,r),r}})}}]);
//# sourceMappingURL=6351.3f2b5acf.js.map