{"version":3,"file":"js/5465.3b74873b.js","mappings":"+OAEO,SAASA,EAAeC,EAAQC,EAASC,EAAO,GACrD,IAAIC,EAAM,sBAAsBD,IAUhC,OARID,IACFE,GAAO,YAAYF,KAGjBD,IACFG,GAAO,WAAWH,MAGbI,EAAAA,EAAAA,GAAQ,CACX,IAAOD,EACP,OAAU,OAEhB,CAEO,SAASE,IACd,OAAOD,EAAAA,EAAAA,GAAQ,CACX,IAAO,cACP,OAAU,OAEhB,CAEO,SAASE,EAAUC,GACxB,OAAOH,EAAAA,EAAAA,GAAQ,CACX,IAAO,mBAAmBG,IAC1B,OAAU,OAEhB,CAEO,SAASC,EAAgBR,GAC9B,OAAOI,EAAAA,EAAAA,GAAQ,CACX,IAAO,wBAAwBJ,IAC/B,OAAU,OAEhB,C,qbCZA,MAQMS,GAAOC,EAAAA,EAAAA,KAAI,G,4hCC5BjB,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,olCCoHA,MAAM,KAAEC,EAAI,eAAEC,EAAc,WAAEC,EAAU,gBAAEC,IAAoBC,EAAAA,EAAAA,KAKxDC,GAAQC,EAAAA,EAAAA,MAERC,EAAQC,EAERC,GAAeX,EAAAA,EAAAA,KAAI,GACnBY,EAAkBC,IACpBC,QAAQC,IAAI,kBACZC,GAAkBC,MAAQJ,EAC1BF,EAAaM,OAAQ,CAAI,EAGvBC,GAAcA,KAChBP,EAAaM,OAAQ,CAAK,EAQxBE,GAAmBA,CAACC,EAASC,EAAO,UACtCC,GAAkBvB,MAAO,EACzBuB,GAAkBF,QAAUA,EAC5BE,GAAkBD,KAAOA,CAAI,EAG3BC,IAAoBC,EAAAA,EAAAA,IAAS,CAC/BxB,MAAM,EACNqB,QAAS,GACTC,KAAM,SAKJG,GAAiBC,IACnB,OAAQA,GACJ,KAAK,EACD,MAAO,SACX,KAAK,EACD,MAAO,QACX,KAAK,EACD,MAAO,QACX,KAAK,EACD,MAAO,iBACX,QACI,MAAO,iBACf,EAIEC,IAAa1B,EAAAA,EAAAA,KAAI,GACjBgB,IAAoBhB,EAAAA,EAAAA,IAAI,MACxB2B,IAAuB3B,EAAAA,EAAAA,IAAI,MAC3B4B,GAAeA,CAACC,EAAWC,KAE7Bd,GAAkBC,MAAQY,EAC1BH,GAAWT,OAAQ,EACnBU,GAAqBV,MAAQa,CAAK,EAGhCC,IAAa/B,EAAAA,EAAAA,IAAI,MACjBgC,GAAenB,IACjBoB,GAAYhB,OAASgB,GAAYhB,MACjCc,GAAWd,MAAQJ,CAAE,EAEnBoB,IAAcjC,EAAAA,EAAAA,KAAI,GAElBkC,IAAYlC,EAAAA,EAAAA,KAAI,GAGhBmC,IAAYZ,EAAAA,EAAAA,IAAS,CACvBa,gBAAiB,MACjBC,cAAe,MAEfC,qBAAsB,MACtBR,MAAO,MACPS,UAAW,QAGTC,GAAcX,KAChBY,EAAAA,EAAAA,IAAoBZ,GAAWa,MAAMC,IACjC,GAAsB,IAAlBA,EAAIC,KAAKC,KAAY,CACrB/B,QAAQC,IAAI,WAAY4B,EAAIC,KAAKA,MACjC,MAAME,EAASH,EAAIC,KAAKA,KACxBT,GAAUC,gBAAkBU,EAAOV,gBAEnCD,GAAUG,qBAAuBS,6CACjCZ,GAAUL,MAAQgB,EAAOhB,MACzBK,GAAUI,UAAYO,EAAOP,UAC7BJ,GAAUE,cAAgBS,EAAOT,cACjCH,GAAUjB,OAAQ,CACtB,MAEIH,QAAQC,IAAI,SAAU4B,EAAIC,KAAKI,IACnC,GACF,EAEAC,GAAqBC,IACvB,MAAMC,GAASC,EAAAA,EAAAA,IAAoB,UAC7BC,EAAQF,EAAOG,MAAKD,GAASA,EAAMH,OAASA,IAC9CG,EAAMxC,GACN0C,GAAaF,EAAMxC,IAEnBC,QAAQ0C,MAAM,cAClB,EAGEC,IAAQzD,EAAAA,EAAAA,IAAI,IACZ0D,IAAc1D,EAAAA,EAAAA,IAAI,GAClB2D,IAAY3D,EAAAA,EAAAA,KAAI,GAEhBuD,GAAeK,MAAOrE,EAASC,EAAO,KACxC,IAAImE,GAAU1C,MAAd,CACA0C,GAAU1C,OAAQ,EAClBH,QAAQC,IAAI,eAAgBxB,EAASC,GACrC,IACI,IAAImD,QAAYtD,EAAAA,EAAAA,IAAekB,EAAMsD,MAAMC,UAAUjD,GAAItB,EAASC,GAC5C,IAAlBmD,EAAIC,KAAKC,KAETY,GAAMxC,MAAQ,IAAIwC,GAAMxC,SAAW0B,EAAIC,KAAKA,MAAQ,IAGpD9B,QAAQ0C,MAAM,QAASb,EAAIC,KAAKI,IAExC,CAAE,MAAOe,GACLjD,QAAQ0C,MAAM,QAASO,EAC3B,CAAE,QACEJ,GAAU1C,OAAQ,CACtB,CAhB2B,CAgB3B,EAGE+C,GAAeA,KACjB,MAAMC,EAAeC,SAASC,gBAAgBF,aACxCG,EAAYF,SAASC,gBAAgBC,UACrCC,EAAeH,SAASC,gBAAgBE,aAE1CD,EAAYC,GAAgBJ,EAAe,IAE3CP,GAAYzC,QACZH,QAAQC,IAAI,WAAY2C,GAAYzC,OACpCsC,GAAa9C,EAAMlB,QAASmE,GAAYzC,OAC5C,GAMJqD,EAAAA,EAAAA,KAAY,KACRC,OAAOC,oBAAoB,SAAUR,GAAa,KAGtDS,EAAAA,EAAAA,KAAM,IAAMhE,EAAMlB,UAAUmF,IACL,OAAfA,IAEAhB,GAAYzC,MAAQ,EACpBwC,GAAMxC,MAAQ,GAGdsC,GAAamB,EAAYhB,GAAYzC,OACzC,KAIJ0D,EAAAA,EAAAA,KAAU,KACN7D,QAAQC,IAAI,oBAAqBR,EAAMsD,MAAMJ,MAAMmB,QAC/CrE,EAAMsD,MAAMJ,MAAMmB,OAAS,GAC3BnB,GAAMxC,MAAQV,EAAMsD,MAAMJ,MAC1BE,GAAU1C,OAAQ,EAClB4D,aAAaC,WAAW,gBAGxBvB,GAAa9C,EAAMlB,SAAW,MAE9BgF,OAAOQ,iBAAiB,SAAUf,IACtC,IAMJ,MAAMgB,GAAapB,UACf,IAAKqB,EAAKC,QAAUD,EAAKE,SAAU,CAC/B,MAAMrC,QAAesC,GAAQH,EAAKpE,IAC9BiC,IAAQmC,EAAKC,OAAQ,EAC7B,GAGEE,GAAUxB,UACZ,IACI,MAAMyB,QAAiBC,EAAAA,EAAAA,IAAW/E,EAAMsD,MAAMC,UAAUjD,GAAI0E,GAC5D,GAA2B,IAAvBF,EAASzC,KAAKC,KAAY,CAE1B,MAAMoC,EAAOxB,GAAMxC,MAAMqC,MAAMkC,GAAMA,EAAE3E,KAAO0E,IAE9C,OADAN,EAAKQ,aACE,CACX,CACJ,CAAE,MAAOjC,GACL1C,QAAQ0C,MAAM,UAAWA,EAC7B,CACA,OAAO,CAAK,EAeVkC,GAAgB9B,UAClB,IAAKqB,EAAKE,WAAaF,EAAKC,MAAO,CAC/B,MAAMpC,QAAe6C,GAAWV,EAAKpE,IACjCiC,IAAQmC,EAAKE,UAAW,EAChC,GAIEQ,GAAa/B,UACf,IACI,MAAMyB,QAAiBO,EAAAA,EAAAA,IAAcrF,EAAMsD,MAAMC,UAAUjD,GAAI0E,GAC/D,GAA2B,IAAvBF,EAASzC,KAAKC,KAAY,CAE1B,MAAMoC,EAAOxB,GAAMxC,MAAMqC,MAAMkC,GAAMA,EAAE3E,KAAO0E,IAE9C,OADAN,EAAKY,gBACE,CACX,CACJ,CAAE,MAAOrC,GACL1C,QAAQ0C,MAAM,SAAUA,EAC5B,CACA,OAAO,CAAK,EAKVsC,GAAiBlC,UACnB9C,QAAQC,IAAI,iBAAkBkE,EAAKc,YAC/Bd,EAAKc,iBACCC,GAAef,EAAKpE,UAEpBoF,GAAYhB,EAAKpE,IAE3BoE,EAAKc,YAAcd,EAAKc,UAAU,EAGhCE,GAAcrC,UAChB,IACI,MAAMyB,QAAiBa,EAAAA,EAAAA,IAAe3F,EAAMsD,MAAMC,UAAUjD,GAAI0E,GAChE,GAA2B,IAAvBF,EAASzC,KAAKC,KAAY,CAC1B,MAAMoC,EAAOxB,GAAMxC,MAAMqC,MAAMkC,GAAMA,EAAE3E,KAAO0E,IAC9CN,EAAKkB,gBACLhF,GAAiB,OAAQ,UAC7B,CACJ,CAAE,MAAOqC,GACL1C,QAAQ0C,MAAM,UAAWA,EAC7B,GAGEwC,GAAiBpC,UACnB,IACI,MAAMyB,QAAiBe,EAAAA,EAAAA,IAAkB7F,EAAMsD,MAAMwC,WAAWxF,GAAI0E,GACpE,GAA2B,IAAvBF,EAASzC,KAAKC,KAAY,CAC1B,MAAMoC,EAAOxB,GAAMxC,MAAMqC,MAAMkC,GAAMA,EAAE3E,KAAO0E,IAC9CN,EAAKkB,gBACLhF,GAAiB,QAAS,UAC9B,CACJ,CAAE,MAAOqC,GACL1C,QAAQ0C,MAAM,UAAWA,EAC7B,GAGE8C,IAAatG,EAAAA,EAAAA,IAAI,IACjBuG,GAAgB3C,UAClB,GAAI0C,GAAWrF,MAAMuF,OACjB,IACI,MAAMC,EAAU,CACZ5E,UAAWoD,EAAKpE,GAChBvB,OAAQiB,EAAMsD,MAAMC,SAASjD,GAC7B6F,QAASJ,GAAWrF,OAElBoE,QAAiBsB,EAAAA,EAAAA,IAAcF,GACV,IAAvBpB,EAASzC,KAAKC,MAEdoC,EAAK2B,eACLN,GAAWrF,MAAQ,IAEnBH,QAAQ0C,MAAM,UAAW6B,EAASzC,KAAKxB,QAE/C,CAAE,MAAOoC,GACL1C,QAAQ0C,MAAM,aAAcA,EAChC,CACJ,E,ulIClaJ,MAAMvD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,kdC6BA,MAAMM,GAAQC,EAAAA,EAAAA,MACRC,EAAQC,EACRmG,GAAW7G,EAAAA,EAAAA,IAAI,IAEf8G,EAAiBlD,UACnB,IAGI,MAAMyB,QAAiB0B,EAAAA,EAAAA,IAAetG,EAAMuG,WAAYzG,EAAMsD,MAAMC,UAAUjD,IACnD,IAAvBwE,EAASzC,KAAKC,MACdgE,EAAS5F,MAAQoE,EAASzC,KAAKA,KAC/B9B,QAAQC,IAAI,YAAa8F,EAAS5F,QAElCH,QAAQ0C,MAAM,YAAa6B,EAASzC,KAAKxB,QAEjD,CAAE,MAAOoC,GACL1C,QAAQ0C,MAAM,eAAgBA,EAClC,GAIEyD,EAAcrD,UAChB,IACI,MAAMtE,EAASiB,EAAMsD,MAAMC,UAAUjD,GAC/BwE,QAAiB6B,EAAAA,EAAAA,IAAeC,EAAW7H,GACjD,GAA2B,IAAvB+F,EAASzC,KAAKC,KAAY,CAE1B,MAAM4D,EAAUI,EAAS5F,MAAMqC,MAAKmD,GAAWA,EAAQ5F,KAAOsG,IAC1DV,IACAA,EAAQhB,WAAa,EACrBgB,EAAQvB,OAAQ,EAExB,MACIpE,QAAQ0C,MAAM,QAAS6B,EAASzC,KAAKxB,QAE7C,CAAE,MAAOoC,GACL1C,QAAQ0C,MAAM,WAAYA,EAC9B,G,OAKJmB,EAAAA,EAAAA,IAAUmC,G,+wBC5EV,MAAM7G,EAAc,EAEpB,O","sources":["webpack://social-vue-3/./src/api/home.js","webpack://social-vue-3/./src/components/float/ChainInfo.vue","webpack://social-vue-3/./src/components/float/ChainInfo.vue?8940","webpack://social-vue-3/./src/views/Apps/Social/Components/SocialPost.vue","webpack://social-vue-3/./src/views/Apps/Social/Components/SocialPost.vue?7c99","webpack://social-vue-3/./src/views/Apps/Social/Components/SocialPostComment.vue","webpack://social-vue-3/./src/views/Apps/Social/Components/SocialPostComment.vue?3b7c"],"sourcesContent":["import { request } from \"../utilities/request.js\";\r\n\r\nexport function articleListApi(userId, boardId, page = 1) {\r\n  let url = `/article/list?page=${page}`;\r\n  \r\n  if (boardId) {\r\n    url += `&boardId=${boardId}`;\r\n  }\r\n  \r\n  if (userId) {\r\n    url += `&userId=${userId}`;\r\n  }\r\n\r\n  return request({\r\n      'url': url,\r\n      'method': 'get',\r\n  });\r\n}\r\n\r\nexport function boardListApi() {\r\n  return request({\r\n      'url': '/board/list',\r\n      'method': 'get',\r\n    })\r\n}\r\n\r\nexport function searchApi(searchWords) {\r\n  return request({\r\n      'url': `/article/search=${searchWords}`,\r\n      'method': 'get',\r\n    })\r\n}\r\n\r\nexport function notificationApi(userId) {\r\n  return request({\r\n      'url': `/notification/userid=${userId}`,\r\n      'method': 'get',\r\n    })\r\n}","<template>\r\n    <div v-if=\"show\" class=\"modal fade show d-block\" tabindex=\"-1\" role=\"dialog\"\r\n        style=\"background: rgba(0, 0, 0, 0.5);\">\r\n        <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">鏈上資訊</h5>\r\n                    <button type=\"button\" class=\"close\" aria-label=\"Close\" @click=\"$emit('close')\">\r\n                        <span aria-hidden=\"true\">&times;</span>\r\n                    </button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <p><strong>交易序號：</strong> {{ chainInfo.transactionHash }}</p>\r\n                    <p><strong>發文者地址：</strong> {{ chainInfo.authorAddress }}</p>\r\n                    <p><strong>智慧合約位址：</strong> {{ chainInfo.smartContractAddress }}</p>\r\n                    <p v-if=\"mode !== 2\"><strong> {{mode === 1? '文章標題：' : '驗證理由：'}}</strong> {{ chainInfo.title }}</p>\r\n                    <p><strong>交易時間：</strong> {{ chainInfo.timestamp }}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, defineProps, withDefaults } from 'vue';\r\n\r\nconst props = defineProps({\r\n  chainInfo: Object,\r\n  mode: {\r\n    type: Number,\r\n    default: 1  // 設置 mode 的預設值為 1\r\n  }\r\n});\r\n\r\nconst show = ref(true); // 控制彈出視窗的顯示與隱藏\r\n</script>\r\n\r\n<style scoped>\r\n/* 根據需要新增自訂樣式 */\r\n.modal-dialog {\r\n    max-width: 600px;\r\n}\r\n\r\n.modal-content {\r\n    padding: 20px;\r\n}\r\n</style>","import script from \"./ChainInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ChainInfo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ChainInfo.vue?vue&type=style&index=0&id=6dced89e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6dced89e\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"col-sm-12\" v-for=\"(post, index) in posts\" :key=\"index\" :class=\"{ 'chained-article': post.chained }\">\r\n        <div class=\"card card-block card-stretch card-height\">\r\n            <div class=\"card-body\">\r\n                <div class=\"user-post-data\">\r\n                    <h3 class=\"m-2\">{{ post.title }}</h3>\r\n                    <div class=\"d-flex justify-content-between\">\r\n                        <router-link :to=\"{ name: 'social.profile2', params: { userId: post.authorId } }\">\r\n                            <img class=\"rounded-circle img-fluid fixed-size-img me-5\"\r\n                                :src=\"'data:image/png;base64,' + post.avatar\" alt=\"\">\r\n                        </router-link>\r\n                        <div class=\"w-100\">\r\n                            <div class=\"d-flex justify-content-between align-items-center\">\r\n                                <div class=\"col-7\">\r\n                                    <div class=\"d-flex align-items-center\">\r\n                                        <router-link\r\n                                            :to=\"{ name: 'social.profile2', params: { userId: post.authorId } }\">\r\n                                            <h4 class=\"mb-0 d-inline-block me-2\">{{ post.authorName }}</h4>\r\n                                        </router-link>\r\n                                        <span class=\"mb-0 text-primary\">{{ formatDate(post.publicationDate) }}</span>\r\n                                    </div>\r\n                                    <p class=\"mb-0 text-muted\" @click=\"handlerClickBoard(post.boardName)\">\r\n                                        {{ post.boardName }}\r\n                                    </p>\r\n                                </div>\r\n                                <div class=\"d-flex justify-content-end align-items-center\">\r\n                                    <!-- 上鏈按鈕 -->\r\n                                    <div class=\"me-2\" v-if=\"post.chained\">\r\n                                        <span class=\"material-symbols-outlined chain-info-highlight\" role=\"button\"\r\n                                            title=\"鏈上資訊\" @click=\"showPopups(post.id)\"\r\n                                            style=\"font-size: 32px; line-height: 1.5; vertical-align: middle;\">\r\n                                            dataset_linked\r\n                                        </span>\r\n                                        <ChainInfo :chainInfo=\"chainInfo\" v-if=\"showPopup\"\r\n                                            @close=\"() => showPopup = false\"></ChainInfo>\r\n                                        <button type=\"button\" class=\"btn btn-outline-primary ms-1\"\r\n                                            @click=\"handleVerify(post.id, post.title)\">發起驗證</button>\r\n                                    </div>\r\n\r\n                                    <!-- 檢查分數按鈕 -->\r\n                                    <div class=\"me-2\">\r\n                                        <!-- <button @click=\"queryBalance\" class=\"btn btn-outline-primary\">查詢餘額</button> -->\r\n                                        <button @click=\"handleAIVerify(post.id)\" class=\"btn btn-primary\"\r\n                                            style=\"white-space: nowrap;\">AI分析</button>\r\n                                        <AIVerify v-if=\"post.id === selectedArticleId && showAIVerify\"\r\n                                            :id=\"post.id\" :title=\"post.title\" :content=\"post.content\" @close=\"handleClose\"></AIVerify>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"mt-3\">\r\n                    <p>{{ post.content }}</p>\r\n                </div>\r\n                <div class=\"user-post\">\r\n                    <div :class=\"{ 'row': post.images.length > 1 }\">\r\n                        <div v-for=\"(pic, picIndex) in post.images\" :key=\"picIndex\"\r\n                            :class=\"getImageClass(post.images.length)\">\r\n                            <img :src=\"'data:image/png;base64,' + pic\" alt=\"post-image\" class=\"img-fluid rounded\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"blog-meta d-flex align-items-center mt-3 mb-3 flex-wrap\">\r\n                    <div class=\"me-4 d-flex align-items-center\" @click=\"toggleLike(post)\">\r\n                        <i class=\"material-symbols-outlined pe-2 md-18 text-primary\"\r\n                            :class=\"{ 'custom-color': post.liked }\">\r\n                            arrow_circle_up\r\n                        </i>{{ post.likeCount }} 支持者\r\n                    </div>\r\n                    <div class=\"me-4 d-flex align-items-center\" @click=\"toggleDislike(post)\">\r\n                        <i class=\"material-symbols-outlined pe-2 md-18 text-primary\"\r\n                            :class=\"{ 'custom-color': post.disliked }\">\r\n                            arrow_circle_down\r\n                        </i>{{ post.dislikeCount }} 不支持者\r\n                    </div>\r\n                    <div @click=\"openComment(post.id)\" class=\"comments me-4 d-flex align-items-center\">\r\n                        <i class=\"material-symbols-outlined pe-2 md-18 text-primary\">\r\n                            mode_comment\r\n                        </i>\r\n                        {{ post.commentCount }} 評論數\r\n                    </div>\r\n                    <div class=\"ms-auto d-flex align-items-center\" @click=\"toggleBookmark(post)\">\r\n                        <i class=\"material-symbols-outlined pe-2 md-18 text-primary\"\r\n                            :class=\"{ 'custom-color': post.bookmarked }\" style=\"font-size: 28px;\">\r\n                            bookmark\r\n                        </i>\r\n                    </div>\r\n                </div>\r\n                <Comment v-if=\"showComment && selectedId === post.id\" :article_id=\"post.id\"></Comment>\r\n                <form v-if=\"selectedId === post.id\" class=\"comment-text d-flex align-items-center mt-3\"\r\n                    action=\"javascript:void(0);\">\r\n                    <input type=\"text\" class=\"form-control rounded\" placeholder=\"輸入你的留言\" v-model=\"newComment\">\r\n                    <div class=\"comment-attagement d-flex\" @click=\"submitComment(post)\">\r\n                        <img src=\"@/assets/images/icon/comment_send.png\" alt=\"userimg\" class=\"me-3 img-fluid\">\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <SocialVerify v-if=\"showVerify\" @close=\"showVerify = false\" @verify=\"verify\" :articleId=\"selectedArticleId\"\r\n        :articleTitle=\"selectedArticleTitle\" />\r\n    <Notification v-if=\"notificationState.show\" :message=\"notificationState.message\" :type=\"notificationState.type\"\r\n        @close=\"notificationState.show = false\" />\r\n    <div v-if=\"isLoading\" class=\"loading-spinner\">\r\n        加載中...\r\n    </div>\r\n\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, reactive, defineProps, watch, onUnmounted } from 'vue';\r\n// import ChainInfo from \"./SocialPostChinInfo.vue\";\r\nimport ChainInfo from \"@/components/float/ChainInfo.vue\";\r\nimport Comment from \"./SocialPostComment.vue\";\r\nimport { articleListApi, searchApi } from \"@/api/home.js\";\r\nimport { articleChainInfoApi, addBookmarkApi, removeBookmarkApi, addLikeApi, addDislikeApi, removeLoveApi, recordBlockchainApi } from '@/api/article.js';\r\nimport { addCommentApi } from '@/api/article.js';\r\nimport { useStore } from 'vuex';\r\nimport { formatDate, getFromLocalStorage } from \"@/utilities/tools.js\";\r\nimport SocialVerify from \"./SocialVerify.vue\";\r\nimport AIVerify from \"@/components/ai/AIVerify.vue\";\r\nimport Notification from \"@/components/float/Notification.vue\";\r\nimport useWeb3 from \"@/hooks/useWeb3.js\";\r\nconst { web3, socialContract, getAccount, contractAddress } = useWeb3();\r\n// const queryBalance = async () => {\r\n//   const num = await socialContract.methods.getBalance().call();\r\n//   console.log(num);\r\n// }\r\nconst store = useStore();\r\n\r\nconst props = defineProps({ boardId: Number });\r\n\r\nconst showAIVerify = ref(false);\r\nconst handleAIVerify = (id) => {\r\n    console.log(\"handleAIVerify\");\r\n    selectedArticleId.value = id;\r\n    showAIVerify.value = true;\r\n}\r\n\r\nconst handleClose = () => {\r\n    showAIVerify.value = false;\r\n};\r\n\r\n// const judgeYourself = (userId) => {\r\n//     // console.log(\"judgeYourself\", String(store.state.userInfo?.id) + \" ==? \"+ String(userId));\r\n//     return String(store.state.userInfo?.id) === String(userId);\r\n// };\r\n\r\nconst showNotification = (message, type = 'info') => {\r\n    notificationState.show = true;\r\n    notificationState.message = message;\r\n    notificationState.type = type;\r\n}\r\n\r\nconst notificationState = reactive({\r\n    show: false,\r\n    message: '',\r\n    type: 'info'\r\n});\r\n\r\n\r\n\r\nconst getImageClass = (imageCount) => {\r\n    switch (imageCount) {\r\n        case 1:\r\n            return 'col-10';  // 單張圖片佔滿整行\r\n        case 2:\r\n            return 'col-6';   // 兩張圖片各佔一半\r\n        case 3:\r\n            return 'col-4';   // 三張圖片各佔三分之一\r\n        case 4:\r\n            return 'col-6 col-md-3'; // 四張圖片佔四分之一\r\n        default:\r\n            return 'col-6 col-md-4';  // 其他情況下，每張圖片佔一定寬度\r\n    }\r\n};\r\n\r\n\r\nconst showVerify = ref(false);\r\nconst selectedArticleId = ref(null);\r\nconst selectedArticleTitle = ref(null);\r\nconst handleVerify = (articleId, title) => {\r\n    // console.log(\"handleVerify\");\r\n    selectedArticleId.value = articleId;\r\n    showVerify.value = true;\r\n    selectedArticleTitle.value = title;\r\n}\r\n\r\nconst selectedId = ref(null);\r\nconst openComment = (id) => {\r\n    showComment.value = !showComment.value;\r\n    selectedId.value = id;\r\n}\r\nconst showComment = ref(false);\r\n\r\nconst showPopup = ref(false); // 控制弹出窗口的显示与隐藏\r\n\r\n// 父组件中的链上信息\r\nconst chainInfo = reactive({\r\n    transactionHash: '...',\r\n    authorAddress: '...',\r\n    // transactionFee: '...',\r\n    smartContractAddress: '...',\r\n    title: '...',\r\n    timestamp: '...'\r\n});\r\n\r\nconst showPopups = (articleId) => {\r\n    articleChainInfoApi(articleId).then((res) => {\r\n        if (res.data.code === 1) {\r\n            console.log(\"res.data\", res.data.data);\r\n            const result = res.data.data;\r\n            chainInfo.transactionHash = result.transactionHash;\r\n            // chainInfo.transactionFee = result.transactionFee;\r\n            chainInfo.smartContractAddress = process.env.VUE_APP_CONTRACT_ADDRESS;\r\n            chainInfo.title = result.title;\r\n            chainInfo.timestamp = result.timestamp;\r\n            chainInfo.authorAddress = result.authorAddress;\r\n            showPopup.value = true;\r\n        }\r\n        else {\r\n            console.log(\"error:\", res.data.msg);\r\n        }\r\n    });\r\n}\r\nconst handlerClickBoard = (name) => {\r\n    const boards = getFromLocalStorage(\"boards\");\r\n    const board = boards.find(board => board.name === name);\r\n    if (board.id) {\r\n        loadArticles(board.id);\r\n    } else {\r\n        console.error('未找到對應的看板 ID');\r\n    }\r\n}\r\n\r\nconst posts = ref([]);\r\nconst currentPage = ref(1);\r\nconst isLoading = ref(false);\r\n\r\nconst loadArticles = async (boardId, page = 1) => {\r\n    if (isLoading.value) return; // 防止多次觸發加載\r\n    isLoading.value = true;\r\n    console.log('loadArticles', boardId, page);\r\n    try {\r\n        let res = await articleListApi(store.state.userInfo?.id, boardId, page);\r\n        if (res.data.code === 1) {\r\n            // 將新文章追加到已有的文章列表中\r\n            posts.value = [...posts.value, ...(res.data.data || [])];\r\n            // console.log(posts.value);\r\n        } else {\r\n            console.error('請求出錯:', res.data.msg);\r\n        }\r\n    } catch (err) {\r\n        console.error('請求出錯:', err);\r\n    } finally {\r\n        isLoading.value = false;\r\n    }\r\n};\r\n\r\nconst handleScroll = () => {\r\n    const scrollHeight = document.documentElement.scrollHeight;\r\n    const scrollTop = document.documentElement.scrollTop;\r\n    const clientHeight = document.documentElement.clientHeight;\r\n\r\n    if (scrollTop + clientHeight >= scrollHeight - 5) {\r\n        // 滾動到底部，請求下一頁的文章\r\n        currentPage.value++;\r\n        console.log('請求下一頁的文章', currentPage.value);\r\n        loadArticles(props.boardId, currentPage.value);\r\n    }\r\n};\r\n\r\n\r\n\r\n// 移除滾動事件監聽器（當組件銷毀時）\r\nonUnmounted(() => {\r\n    window.removeEventListener('scroll', handleScroll);\r\n});\r\n\r\nwatch(() => props.boardId, (newBoardId) => {\r\n    if (newBoardId !== null) {\r\n        // 重置頁碼和文章列表\r\n        currentPage.value = 1;\r\n        posts.value = [];\r\n\r\n        // 加載新的文章\r\n        loadArticles(newBoardId, currentPage.value);\r\n    }\r\n});\r\n\r\n\r\nonMounted(() => {\r\n    console.log(\"store.state.posts\", store.state.posts.length);\r\n    if (store.state.posts.length > 0) {\r\n        posts.value = store.state.posts;\r\n        isLoading.value = false;\r\n        localStorage.removeItem(\"searchData\");\r\n    }\r\n    else {\r\n        loadArticles(props.boardId || null);\r\n        // 監聽滾動事件\r\n        window.addEventListener('scroll', handleScroll);\r\n    }\r\n\r\n});\r\n\r\n\r\n\r\nconst toggleLike = async (post) => {\r\n    if (!post.liked && !post.disliked) {\r\n        const result = await addLike(post.id);\r\n        if (result) post.liked = true;\r\n    }\r\n};\r\n\r\nconst addLike = async (postId) => {\r\n    try {\r\n        const response = await addLikeApi(store.state.userInfo?.id, postId);\r\n        if (response.data.code === 1) {\r\n            // console.log(response.data.data);\r\n            const post = posts.value.find((p) => p.id === postId);\r\n            post.likeCount++;\r\n            return true;\r\n        }\r\n    } catch (error) {\r\n        console.error('添加愛心失敗:', error);\r\n    }\r\n    return false;\r\n};\r\n\r\nconst removeLove = async (postId) => {\r\n    try {\r\n        const response = await removeLoveApi(store.state.$userInfo.id, postId);\r\n        if (response.data.code === 1) {\r\n            const post = posts.value.find((p) => p.id === postId);\r\n            post.likeCount--;\r\n        }\r\n    } catch (error) {\r\n        console.error('取消愛心失敗:', error);\r\n    }\r\n};\r\n\r\nconst toggleDislike = async (post) => {\r\n    if (!post.disliked && !post.liked) {\r\n        const result = await addDislike(post.id);\r\n        if (result) post.disliked = true;\r\n    }\r\n\r\n};\r\n\r\nconst addDislike = async (postId) => {\r\n    try {\r\n        const response = await addDislikeApi(store.state.userInfo?.id, postId);\r\n        if (response.data.code === 1) {\r\n            // console.log(response.data.data);\r\n            const post = posts.value.find((p) => p.id === postId);\r\n            post.dislikeCount++;\r\n            return true;\r\n        }\r\n    } catch (error) {\r\n        console.error('不支持失敗:', error);\r\n    }\r\n    return false;\r\n};\r\n\r\n\r\n\r\nconst toggleBookmark = async (post) => {\r\n    console.log(\"toggleBookmark\", post.bookmarked);\r\n    if (post.bookmarked) {\r\n        await removeBookmark(post.id);\r\n    } else {\r\n        await addBookmark(post.id);\r\n    }\r\n    post.bookmarked = !post.bookmarked;\r\n};\r\n\r\nconst addBookmark = async (postId) => {\r\n    try {\r\n        const response = await addBookmarkApi(store.state.userInfo?.id, postId);\r\n        if (response.data.code === 1) {\r\n            const post = posts.value.find((p) => p.id === postId);\r\n            post.bookmarkCount++;\r\n            showNotification('收藏成功', 'success');\r\n        }\r\n    } catch (error) {\r\n        console.error('添加收藏失敗:', error);\r\n    }\r\n};\r\n\r\nconst removeBookmark = async (postId) => {\r\n    try {\r\n        const response = await removeBookmarkApi(store.state.$userInfo?.id, postId);\r\n        if (response.data.code === 1) {\r\n            const post = posts.value.find((p) => p.id === postId);\r\n            post.bookmarkCount--;\r\n            showNotification('取消藏成功', 'success');\r\n        }\r\n    } catch (error) {\r\n        console.error('取消收藏失敗:', error);\r\n    }\r\n};\r\n\r\nconst newComment = ref('');\r\nconst submitComment = async (post) => {\r\n    if (newComment.value.trim()) {\r\n        try {\r\n            const comment = {\r\n                articleId: post.id,\r\n                userId: store.state.userInfo.id, // 確保 userId 是正確的\r\n                content: newComment.value,\r\n            };\r\n            const response = await addCommentApi(comment);\r\n            if (response.data.code === 1) {\r\n                // await getCommentList(); // 刷新評論列表\r\n                post.commentCount++;\r\n                newComment.value = '';\r\n            } else {\r\n                console.error('發表評論失敗:', response.data.message);\r\n            }\r\n        } catch (error) {\r\n            console.error('發表評論時發生錯誤:', error);\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.custom-color {\r\n    color: red !important;\r\n}\r\n\r\n.img-fluid {\r\n    margin-right: 0;\r\n    margin-left: 0;\r\n}\r\n\r\n.fixed-size-img {\r\n    width: 75px;\r\n    height: 75px;\r\n    object-fit: cover;\r\n}\r\n\r\n.chained-article {\r\n    border-left: 5px solid #fadc7c;\r\n    /* 高亮邊框 */\r\n    background-color: #f5faff;\r\n    /* 背景顏色 */\r\n}\r\n</style>","import script from \"./SocialPost.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SocialPost.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./SocialPost.vue?vue&type=style&index=0&id=53b6e371&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-53b6e371\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"comment-area mt-3\">\r\n        <hr>\r\n        <ul class=\"post-comments list-inline p-0 m-0\">\r\n            <li v-for=\"(comment, commentIndex) in comments\" :key=\"commentIndex\">\r\n                <div class=\"d-flex\">\r\n                    <div class=\"user-img\">\r\n                        <img :src=\"'data:image/png;base64,' + comment.avatar\" alt=\"userimg\"\r\n                            class=\"avatar-35 rounded-circle img-fluid\">\r\n                    </div>\r\n                    <div class=\"comment-data-block ms-3\">\r\n                        <div class=\"d-flex align-items-center\">\r\n                            <h6 class=\"mb-0\">{{ comment.authorName }}</h6>\r\n                            <span class=\"ms-2 text-muted\">{{ formatDate(comment.commentDate) }}</span>\r\n                        </div>\r\n                        <p class=\"mb-0\">{{ comment.content }}</p>\r\n                        <div>\r\n                            <button @click=\"likeComment(comment.id)\" class=\"btn btn-link p-0\">\r\n                                <i class=\"material-symbols-outlined\" :class=\"{ 'text-primary': comment.liked }\">\r\n                                    thumb_up\r\n                                </i>\r\n                                {{ comment.likeCount }}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, defineProps, defineExpose } from 'vue';\r\nimport { commentListApi, likeCommentApi } from '@/api/article.js';\r\nimport { formatDate } from \"@/utilities/tools.js\";\r\nimport { useStore } from 'vuex';\r\n\r\nconst store = useStore();\r\nconst props = defineProps({ article_id: String });\r\nconst comments = ref([]);\r\n\r\nconst getCommentList = async () => {\r\n    try {\r\n        // console.log(\"props.article_id:\", props.article_id);\r\n        // console.log(\"store.userInfo.id:\", store.state.userInfo?.id);\r\n        const response = await commentListApi(props.article_id, store.state.userInfo?.id);\r\n        if (response.data.code === 1) {\r\n            comments.value = response.data.data;\r\n            console.log(\"comments:\", comments.value);\r\n        } else {\r\n            console.error('取得評論列表失敗:', response.data.message);\r\n        }\r\n    } catch (error) {\r\n        console.error('取得評論列表時發生錯誤:', error);\r\n    }\r\n};\r\n\r\n\r\nconst likeComment = async (commentId) => {\r\n    try {\r\n        const userId = store.state.userInfo?.id; // 確保 userId 是正確的\r\n        const response = await likeCommentApi(commentId, userId);\r\n        if (response.data.code === 1) {\r\n            // 讓按讚數加一\r\n            const comment = comments.value.find(comment => comment.id === commentId);\r\n            if (comment) {\r\n                comment.likeCount += 1;\r\n                comment.liked = true;\r\n            }\r\n        } else {\r\n            console.error('按讚失敗:', response.data.message);\r\n        }\r\n    } catch (error) {\r\n        console.error('按讚時發生錯誤:', error);\r\n    }\r\n};\r\n// defineExpose({\r\n//     submitComment,\r\n// });\r\nonMounted(getCommentList);\r\n</script>\r\n\r\n<style lang=\"less\"></style>","import script from \"./SocialPostComment.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SocialPostComment.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["articleListApi","userId","boardId","page","url","request","boardListApi","searchApi","searchWords","notificationApi","show","ref","__exports__","web3","socialContract","getAccount","contractAddress","useWeb3","store","useStore","props","__props","showAIVerify","handleAIVerify","id","console","log","selectedArticleId","value","handleClose","showNotification","message","type","notificationState","reactive","getImageClass","imageCount","showVerify","selectedArticleTitle","handleVerify","articleId","title","selectedId","openComment","showComment","showPopup","chainInfo","transactionHash","authorAddress","smartContractAddress","timestamp","showPopups","articleChainInfoApi","then","res","data","code","result","process","msg","handlerClickBoard","name","boards","getFromLocalStorage","board","find","loadArticles","error","posts","currentPage","isLoading","async","state","userInfo","err","handleScroll","scrollHeight","document","documentElement","scrollTop","clientHeight","onUnmounted","window","removeEventListener","watch","newBoardId","onMounted","length","localStorage","removeItem","addEventListener","toggleLike","post","liked","disliked","addLike","response","addLikeApi","postId","p","likeCount","toggleDislike","addDislike","addDislikeApi","dislikeCount","toggleBookmark","bookmarked","removeBookmark","addBookmark","addBookmarkApi","bookmarkCount","removeBookmarkApi","$userInfo","newComment","submitComment","trim","comment","content","addCommentApi","commentCount","comments","getCommentList","commentListApi","article_id","likeComment","likeCommentApi","commentId"],"sourceRoot":""}