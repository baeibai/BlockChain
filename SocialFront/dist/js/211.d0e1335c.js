"use strict";(self["webpackChunksocial_vue_3"]=self["webpackChunksocial_vue_3"]||[]).push([[211],{5292:function(e,t,a){a.d(t,{D7:function(){return s},rK:function(){return o},s:function(){return n}});var r=a(6593);function n(e){return(0,r.E)({url:"/user/login",method:"post",data:e})}function o(e){return(0,r.E)({url:"/user/signUp",method:"post",data:e})}function s(e){return(0,r.E)({url:`/user/checkUsername/${e}`,method:"get"})}},3761:function(e,t,a){a.d(t,{A:function(){return i}});var r=a(641),n=a(33),o={__name:"Notification",props:{message:{type:String,required:!0},type:{type:String,default:"info"}},emits:["close"],setup(e,{emit:t}){const a=e,o=t,s=(0,r.EW)((()=>{switch(a.type){case"success":return"success";case"warning":return"warning";case"error":return"error";default:return"info"}})),l=()=>{o("close")};return(0,r.sV)((()=>{setTimeout((()=>{l()}),3e3)})),(t,a)=>((0,r.uX)(),(0,r.CE)("div",{class:(0,n.C4)(["notification",s.value])},[(0,r.Lk)("span",null,(0,n.v_)(e.message),1)],2))}},s=a(6262);const l=(0,s.A)(o,[["__scopeId","data-v-07b198c4"]]);var i=l},211:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});a(4114);var r=a(641),n=a(3751),o=a(953),s=a(98),l=a(5220),i=a(5292),u=a(3761);const c={class:"sign-in-page"},d={class:"container p-0"},m={class:"row no-gutters"},p={class:"col-md-6 bg-white pt-5 pt-5 pb-lg-0 pb-5"},f={class:"sign-in-from pb-5"},v={class:"mb-0"},g={class:"form-group"},h={class:"form-group"},b={class:"form-group d-flex align-items-center"},k={class:"form-group"},w={class:"form-group"},y={key:0,class:"text-danger mb-3"},L={class:"d-inline-block w-100"},x={class:"dark-color d-inline-block line-height-2"};var M={__name:"SignUp",setup(e){const t=(0,l.rd)(),{web3:a,socialContract:M,getAccount:_,contractAddress:I}=(0,s.A)(),E=(0,o.KR)(""),C=(0,o.KR)(""),A=(0,o.KR)(""),K=(0,o.KR)(""),U=(0,o.KR)(""),P=(0,o.Kh)({show:!1,message:"",type:"info"});let V=!1;const T=(e,t="info")=>{P.message=e,P.type=t,P.show=!0};async function F(){if(V)T("正在處理連接請求，請稍候...","info");else if(window.ethereum){console.log("MetaMask 已安裝");try{V=!0;const e=await window.ethereum.request({method:"eth_requestAccounts"});e.length>0?(K.value=e[0],console.log("MetaMask 登入成功，地址:",K.value),T("MetaMask 連接成功！","success")):T("請登入 MetaMask","warning")}catch(e){-32002===e.code?T("請求已在處理中，請稍候...","info"):(console.error("連接 MetaMask 失敗:",e),T("MetaMask 連接失敗，請重試。","error"))}finally{V=!1}}else T("未偵測到 MetaMask，請先安裝!","error")}const J=async e=>{try{const t=await _();console.log(t);const a={from:t,to:I,value:"0",data:M.methods.registerUser(e).encodeABI()},r=await window.ethereum.request({method:"eth_sendTransaction",params:[a]});return console.log("交易已提交，交易哈希:",r),T("交易已提交，交易哈希: "+r,"success"),!0}catch(t){return console.error("發送交易時出錯:",t),T("發送交易時出錯: "+t.message,"error"),!1}},R=async()=>{if(!K.value&&(T("請先連接 MetaMask","warning"),await F(),!K.value))return;if(!q(E.value))return void T("請輸入有效的電子郵件地址。","warning");if(C.value.length<6)return T("密碼必須至少為 6 個字符長。","warning"),void(C.value="");if(!A.value.trim())return void T("請輸入用戶名稱。","warning");if(A.value.length>20)return void T("用戶名稱需小於20字。","warning");if(!K.value.trim())return void T("請輸入以太坊地址。","warning");if(C.value!==U.value)return void T("密碼不匹配，請重新輸入。","warning");const e={email:E.value,address:K.value,username:A.value,password:C.value};try{const a=await(0,i.D7)(A.value);if(0===a.data.code)return void T(a.data.msg,"warning");const r=await J(A.value);if(!r)return void T("交易失敗","error");const n=await(0,i.rK)(e);1===n.data.code?(T("註冊成功!","success"),t.push("/auth/signin")):T("請求出錯: "+n.data.msg,"error")}catch(a){console.error("請求出錯:",a.message),T("請求出錯: "+a.message,"error")}console.log("Form submitted!")},q=e=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)};return(0,r.sV)((()=>{})),(e,t)=>{const a=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("section",c,[t[18]||(t[18]=(0,r.Fv)('<div id="container-inside" data-v-6ac956de><div id="circle-small" data-v-6ac956de></div><div id="circle-medium" data-v-6ac956de></div><div id="circle-large" data-v-6ac956de></div><div id="circle-xlarge" data-v-6ac956de></div><div id="circle-xxlarge" data-v-6ac956de></div></div>',1)),(0,r.Lk)("div",d,[(0,r.Lk)("div",m,[t[17]||(t[17]=(0,r.Lk)("div",{class:"col-md-6 text-center pt-5"},null,-1)),(0,r.Lk)("div",p,[(0,r.Lk)("div",f,[(0,r.Lk)("h1",v,[(0,r.bF)(a,{to:{name:"social.list"}},{default:(0,r.k6)((()=>t[7]||(t[7]=[(0,r.eW)("註冊")]))),_:1})]),(0,r.Lk)("form",{class:"mt-4",onSubmit:(0,n.D$)(R,["prevent"])},[(0,r.Lk)("div",g,[t[8]||(t[8]=(0,r.Lk)("label",{class:"form-label",for:"exampleInputEmail2"},"電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",class:"form-control mb-0",id:"exampleInputEmail2","onUpdate:modelValue":t[0]||(t[0]=e=>E.value=e),placeholder:"電子郵件"},null,512),[[n.Jo,E.value]])]),(0,r.Lk)("div",h,[t[9]||(t[9]=(0,r.Lk)("label",{class:"form-label",for:"exampleInputusername"},"用戶名稱",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control mb-0",id:"exampleInputusername","onUpdate:modelValue":t[1]||(t[1]=e=>A.value=e),placeholder:"用戶名稱"},null,512),[[n.Jo,A.value]])]),(0,r.Lk)("div",b,[t[10]||(t[10]=(0,r.Lk)("label",{class:"form-label float-start",for:"exampleInputethereum1",style:{"margin-bottom":"0"}},"以太坊地址",-1)),t[11]||(t[11]=(0,r.Lk)("span",{style:{"flex-grow":"1"}},null,-1)),t[12]||(t[12]=(0,r.Lk)("label",{class:"form-label",for:"exampleInputethereum1",style:{"margin-bottom":"0"}},[(0,r.Lk)("a",{href:"https://metamask.io/download/"},"點擊了解如何註冊及連接")],-1)),(0,r.Lk)("button",{type:"button",class:"btn btn-outline-primary mb-3 ms-3 float-end",style:{"margin-left":"auto"},onClick:t[2]||(t[2]=e=>F())},"連接錢包")]),(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",id:"exampleInputethereum1","onUpdate:modelValue":t[3]||(t[3]=e=>K.value=e),placeholder:"以太坊地址",rows:"2"},null,512),[[n.Jo,K.value]]),(0,r.Lk)("div",k,[t[13]||(t[13]=(0,r.Lk)("label",{class:"form-label",for:"exampleInputPassword1"},"密碼",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control mb-0",id:"exampleInputPassword1","onUpdate:modelValue":t[4]||(t[4]=e=>C.value=e),placeholder:"密碼"},null,512),[[n.Jo,C.value]])]),(0,r.Lk)("div",w,[t[14]||(t[14]=(0,r.Lk)("label",{class:"form-label",for:"exampleInputConfirmPassword1"},"確認密碼",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control mb-0",id:"exampleInputConfirmPassword1","onUpdate:modelValue":t[5]||(t[5]=e=>U.value=e),placeholder:"確認密碼"},null,512),[[n.Jo,U.value]])]),e.passwordMismatch?((0,r.uX)(),(0,r.CE)("div",y," 密碼不匹配，請重新輸入。 ")):(0,r.Q3)("",!0),(0,r.Lk)("div",L,[(0,r.Lk)("span",x,[(0,r.bF)(a,{to:{name:"auth.sign-in"}},{default:(0,r.k6)((()=>t[15]||(t[15]=[(0,r.eW)("返回登入")]))),_:1})]),t[16]||(t[16]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary float-end"},"註冊",-1))])],32)])])])])]),P.show?((0,r.uX)(),(0,r.Wv)(u.A,{key:0,message:P.message,type:P.type,onClose:t[6]||(t[6]=e=>P.show=!1)},null,8,["message","type"])):(0,r.Q3)("",!0)],64)}}},_=a(6262);const I=(0,_.A)(M,[["__scopeId","data-v-6ac956de"]]);var E=I},4527:function(e,t,a){var r=a(3724),n=a(4376),o=TypeError,s=Object.getOwnPropertyDescriptor,l=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,t){if(n(e)&&!s(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},6837:function(e){var t=TypeError,a=9007199254740991;e.exports=function(e){if(e>a)throw t("Maximum allowed index exceeded");return e}},4114:function(e,t,a){var r=a(6518),n=a(8981),o=a(6198),s=a(4527),l=a(6837),i=a(9039),u=i((function(){return 4294967297!==[].push.call({length:4294967296},1)})),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=u||!c();r({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=n(this),a=o(t),r=arguments.length;l(a+r);for(var i=0;i<r;i++)t[a]=arguments[i],a++;return s(t,a),a}})}}]);
//# sourceMappingURL=211.d0e1335c.js.map